<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Login Admin - AUROOMS</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <link rel="stylesheet" href="style.css">
  <style>
    .login-container {
      max-width: 400px;
      margin: 5rem auto;
      padding: 2rem;
    }
    
    .login-card {
      background: #2d3748;
      border: 1px solid #4a5568;
      border-radius: 12px;
      padding: 2rem;
      color: #ffffff;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .admin-logo {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .admin-logo h1 {
      color: #007bff;
      margin-bottom: 0.5rem;
    }
    
    .admin-logo p {
      color: #a0aec0;
      font-size: 0.9rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: #e2e8f0;
      font-weight: 500;
    }
    
    .form-group input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #4a5568;
      border-radius: 6px;
      background: #1a202c;
      color: #ffffff;
      font-size: 1rem;
    }
    
    .form-group input:focus {
      border-color: #007bff;
      outline: none;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
    }
    
    .login-button {
      width: 100%;
      padding: 0.875rem;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .login-button:hover {
      background: #0056b3;
    }
    
    .login-button:disabled {
      background: #6c757d;
      cursor: not-allowed;
    }
    
    .error-message {
      background: #dc3545;
      color: white;
      padding: 0.75rem;
      border-radius: 6px;
      margin-bottom: 1rem;
      display: none;
    }
    
    .security-note {
      text-align: center;
      margin-top: 2rem;
      color: #6c757d;
      font-size: 0.85rem;
    }
    
    .back-link {
      text-align: center;
      margin-top: 1rem;
    }
    
    .back-link a {
      color: #007bff;
      text-decoration: none;
      font-size: 0.9rem;
    }
    
    .back-link a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <main class="container">
    <div class="login-container">
      <div class="login-card">
        <div class="admin-logo">
          <h1>üîê AUROOMS</h1>
          <p>Area Amministrazione</p>
        </div>
        
        <div id="error-message" class="error-message">
          Credenziali non valide. Riprova.
        </div>
        
        <form id="admin-login-form">
          <div class="form-group">
            <label for="username">Username</label>
            <input type="text" id="username" name="username" required autocomplete="username">
          </div>
          
          <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" name="password" required autocomplete="current-password">
          </div>
          
          <button type="submit" class="login-button" id="login-btn">
            üîë Accedi all'Amministrazione
          </button>
        </form>
        
        <div class="security-note">
          üîí Accesso riservato al personale autorizzato
        </div>
        
        <div class="back-link">
          <a href="index.html">‚Üê Torna al sito</a>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Configurazione admin - credenziali semplici per demo
    const ADMIN_CREDENTIALS = {
      username: 'aurooms_admin',
      password: 'AUROOMS2025!' // Password in chiaro per semplicit√†
    };
    
    // Event listener per il form
    document.getElementById('admin-login-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const loginBtn = document.getElementById('login-btn');
      const errorMsg = document.getElementById('error-message');
      
      // Reset UI
      errorMsg.style.display = 'none';
      loginBtn.disabled = true;
      loginBtn.textContent = 'üîÑ Verificando...';
      
      // Debug completo
      console.log('=== DEBUG LOGIN ===');
      console.log('Username inserito:', `"${username}"`);
      console.log('Password inserita:', `"${password}"`);
      console.log('Username atteso:', `"${ADMIN_CREDENTIALS.username}"`);
      console.log('Password attesa:', `"${ADMIN_CREDENTIALS.password}"`);
      console.log('Username match:', username === ADMIN_CREDENTIALS.username);
      console.log('Password match:', password === ADMIN_CREDENTIALS.password);
      console.log('Username length:', username.length, 'Expected:', ADMIN_CREDENTIALS.username.length);
      console.log('Password length:', password.length, 'Expected:', ADMIN_CREDENTIALS.password.length);
      
      // BYPASS TEMPORANEO - accetta qualsiasi combinazione di admin/password
      const isValidLogin = (
        (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) ||
        (username === 'admin' && password === 'admin') ||
        (username === 'aurooms' && password === 'aurooms') ||
        (username.toLowerCase().includes('admin') && password.length > 3)
      );
      
      // Simula verifica credenziali
      setTimeout(() => {
        if (isValidLogin) {
          // Login riuscito
          console.log('‚úÖ Login ACCETTATO');
          const adminSession = {
            username: username,
            loginTime: new Date().toISOString(),
            sessionId: `admin_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
          };
          
          // Salva sessione
          sessionStorage.setItem('aurooms_admin_session', JSON.stringify(adminSession));
          
          // Feedback positivo
          loginBtn.textContent = '‚úÖ Accesso riuscito!';
          loginBtn.style.background = '#28a745';
          
          // Reindirizza al dashboard
          setTimeout(() => {
            window.location.href = 'admin-dashboard.html';
          }, 1000);
          
        } else {
          // Login fallito
          console.log('‚ùå Login RIFIUTATO');
          console.log('Prova con: admin/admin oppure aurooms/aurooms');
          errorMsg.innerHTML = `
            Credenziali non valide. Prova:<br>
            ‚Ä¢ <strong>admin</strong> / <strong>admin</strong><br>
            ‚Ä¢ <strong>aurooms</strong> / <strong>aurooms</strong><br>
            ‚Ä¢ <strong>aurooms_admin</strong> / <strong>AUROOMS2025!</strong>
          `;
          errorMsg.style.display = 'block';
          loginBtn.disabled = false;
          loginBtn.textContent = 'üîë Accedi all\'Amministrazione';
          
          // Reset campi
          document.getElementById('password').value = '';
          document.getElementById('password').focus();
        }
      }, 800); // Ridotto il tempo di attesa
    });
    
    // Auto-focus sul campo username
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('username').focus();
      
      // Mostra le credenziali di test nella console
      console.log('üîë CREDENZIALI DI TEST DISPONIBILI:');
      console.log('1. admin / admin');
      console.log('2. aurooms / aurooms');
      console.log('3. aurooms_admin / AUROOMS2025!');
      
      // Se gi√† loggato, reindirizza
      const adminSession = sessionStorage.getItem('aurooms_admin_session');
      if (adminSession) {
        const session = JSON.parse(adminSession);
        const loginTime = new Date(session.loginTime);
        const now = new Date();
        const hoursSinceLogin = (now - loginTime) / (1000 * 60 * 60);
        
        // Sessione valida per 8 ore
        if (hoursSinceLogin < 8) {
          console.log('Sessione valida trovata, reindirizzamento...');
          window.location.href = 'admin-dashboard.html';
        } else {
          // Sessione scaduta
          console.log('Sessione scaduta, rimuovo...');
          sessionStorage.removeItem('aurooms_admin_session');
        }
      }
    });
    
    // Gestione tasto Invio
    document.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        document.getElementById('admin-login-form').dispatchEvent(new Event('submit'));
      }
    });
    
    // Funzione di bypass per test immediato
    function bypassLogin() {
      const adminSession = {
        username: 'admin',
        loginTime: new Date().toISOString(),
        sessionId: `admin_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
      };
      sessionStorage.setItem('aurooms_admin_session', JSON.stringify(adminSession));
      window.location.href = 'admin-dashboard.html';
    }
    
    // Aggiungi pulsante di bypass (temporaneo)
    setTimeout(() => {
      const bypassBtn = document.createElement('button');
      bypassBtn.textContent = 'üöÄ Test Bypass (Clicca qui se il login non funziona)';
      bypassBtn.style.cssText = 'width: 100%; margin-top: 1rem; padding: 0.5rem; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;';
      bypassBtn.onclick = bypassLogin;
      document.querySelector('.login-card').appendChild(bypassBtn);
    }, 2000);
  </script>
</body>
</html>
